<?php
session_start();

/*
|--------------------------------------------------------------------------
| CONFIG
|--------------------------------------------------------------------------
*/


/*
|--------------------------------------------------------------------------
| CONFIG
|--------------------------------------------------------------------------
*/

$timeout = 1800; // 30 minutes
$bannedIPs = [
    // '123.123.123.123',
];

/*
|--------------------------------------------------------------------------
| SESSION TIMEOUT CHECK
|--------------------------------------------------------------------------
*/
if (isset($_SESSION['session_time']) && (time() - $_SESSION['session_time']) > $timeout) {
    session_unset();
    session_destroy();
    header("Location: login/login.php");
    exit();
}

$_SESSION['session_time'] = time();

/*
|--------------------------------------------------------------------------
| IP BAN CHECK
|--------------------------------------------------------------------------
*/
$userIP = $_SERVER['REMOTE_ADDR'];

if (in_array($userIP, $bannedIPs)) {
    http_response_code(403);
    exit('Access denied.');
}

/*
|--------------------------------------------------------------------------
| DEVICE / MEDIA CHECK (BASIC)
|--------------------------------------------------------------------------
*/
$userAgent = $_SERVER['HTTP_USER_AGENT'] ?? 'Unknown';

/*
|--------------------------------------------------------------------------
| VPN CHECK (PLACEHOLDER)
|--------------------------------------------------------------------------
| Later you can:
| - Use an API (ipinfo, iphub, vpnapi)
| - Compare ASN / proxy headers
*/
$isVPN = false; // default assumption

if ($isVPN === true) {
    header("Location: vpn-warning.php");
    exit();
}

/*
|--------------------------------------------------------------------------
| REDIRECT TO LOGIN
|--------------------------------------------------------------------------
*/
header("Location: login/login.php");
exit();
